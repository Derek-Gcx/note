# 并发bug调试

+ TODO：QEMU调试

## 死锁
+ 多个进程互相等待
+ 两种类型
  + AA型死锁：同一个线程想要上同一把锁两次，或者是中断处理程序对线程上锁时产生死锁
  + ABBA型死锁：互相加锁等待
+ 死锁产生的必要条件
  + 互斥：一个资源只能被一个资源使用
  + 请求与保持：一个进程请求资源被阻塞时，不会释放已获得的资源
  + 不剥夺：进程已有的资源不能强行剥夺
  + 循环等待：若干进程之间形成头尾相接的等待序列
+ 避免AA
  + 较为简单，直接检测，然后调整代码即可
+ 避免ABBA
  + 严格按照相同的顺序依次获得锁（lock ordering）
  + 在任意时刻获得最靠右的锁的线程一定可以进行
  + 预测分析：TODO

## 并发bug
